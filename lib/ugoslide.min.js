(function(){var a;a=function(){function a(a){var b=this;null==a&&(a={}),this.options=$.extend({root:".ugoslide",observe:{fontSize:"10px",fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",color:"#fff"},scalable:!0,bore:!1},a),this.$root=$(this.options.root),this.pages=this.$root.children(".ugoslide-page").map(function(){return $(this)}),this.wordElems={},this.initElements(),this.compile(),setTimeout(function(){return b.showAt(0)},this.pageDuration())}return a.prototype.escape=function(a){return"#"+a},a.prototype.unescape=function(a){return a.substr(1)},a.prototype.pageDuration=function(){var a;return this.options.scalable?(a=$(".ugoslide-page").css("transitionDuration"),1e3*Number(a.substr(0,a.length-1))):0},a.prototype.initElements=function(){var a,b,c=this;return 0===this.$root.find(".ugoslide-navigator").length&&this.$root.append('<div class="ugoslide-navigator">\n  <a href="#" class="ugoslide-prev">&lt;&lt;</a>\n  <span class="ugoslide-current"></span>\n  <a href="#" class="ugoslide-next">&gt;&gt;</a>\n</div>'),this.$navigatorCurrent=$(".ugoslide-current"),$(".ugoslide-prev").on("click",function(){return c.showPrev()}),$(".ugoslide-next").on("click",function(){return c.showNext()}),$(window).on("keydown",function(a){switch(a.which){case 37:return c.showPrev();case 39:return c.showNext()}}),this.options.scalable&&(b=function(){var a;return a=Math.min(c.$root[0].clientWidth,c.$root[0].clientHeight)/30,c.$root.css("font-size",a)},$(window).on("resize",function(){return b(),setTimeout(function(){return c.showCurrent()},c.pageDuration())}),b()),this.options.bore?void 0:(0===this.$root.find(".ugoslide-words").length&&this.$root.append('<div class="ugoslide-words"></div>'),this.$words=this.$root.find(".ugoslide-words"),a=function(a){var b;return c.$words.css("display","none"),b=document.elementFromPoint(a.pageX,a.pageY),c.$words.css("display","block"),$(b)},this.$words.on("click",function(b){return a(b).trigger(b)}),this.$words.on("mousemove",function(b){return c.$words.css("cursor",a(b).css("cursor"))}))},a.prototype.compile=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this;if(!this.options.bore){for(e=function(a,b){return a.contents().each(function(){switch(this.nodeType){case 3:return b(this);case 1:return e($(this),b)}})},j={},n=this.pages,l=0,m=n.length;m>l;l++){a=n[l],e(a,function(a){var b;if(/\S/.test(a.data))return b=p.splitText(a.data),$(a).replaceWith(b)}),i={},a.find(".ugoslide-word-base").each(function(a,b){var c,d;return c=p.escape($(b).text()),i[c]=(null!=(d=i[c])?d:0)+1});for(f in i)c=i[f],j[f]=Math.max(null!=(o=j[f])?o:0,c)}for(g in j)c=j[g],h=this.unescape(g),this.wordElems[g]=function(){var a,e;for(e=[],k=a=1;c>=1?c>=a:a>=c;k=c>=1?++a:--a)d=this.cssSplashed(),d.transitionDuration=this.transitionDuration(h)+"s",b=$("<span />",{"class":"ugoslide-word",text:h,css:d}),b.showed=!1,this.$words.append(b),e.push(b);return e}.call(this);return $(".ugoslide-word-base").each(function(){return b=$(this),b.data("color",b.css("color")),b.css("color","rgba(0,0,0,0)")})}},a.prototype.splitText=function(a){var b,c,d,e,f,g,h,i,j,k;for(c='<span class="ugoslide-word-base">',b="</span>",h="",i="",e=this.characterGroup(a.charCodeAt(0)),f=0,g=function(){return 0!==i.length?(h+="space"===e?i:c+i+b,i=""):void 0},f=j=0,k=a.length;k>=0?k>j:j>k;f=k>=0?++j:--j)d=this.characterGroup(a.charCodeAt(f),e),d!==e&&(g(),e=d),i+=a.charAt(f);return g(),h},a.prototype.showAt=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this;if(null==b&&(b=!1),(a!==this.index||b)&&(null!=this.index&&this.pages[this.index].css({opacity:0,zIndex:1}),this.index=a,null!=a&&(c=this.pages[a],c.css({opacity:1,zIndex:2}),this.$navigatorCurrent.html(""+(this.index+1)+"/"+this.pages.length),!this.options.bore))){h={},l=this.wordElems;for(f in l)e=l[f],h[f]=$.merge([],e);c.find(".ugoslide-word-base").each(function(a,b){var c,d;return c=$(b),d=m.choiceRandom(h[m.escape(c.text())]),d.showed=!0,d.css(m.cssReflecting(c))});for(i in h)for(g=h[i],j=0,k=g.length;k>j;j++)d=g[j],(d.showed||b)&&(d.showed=!1,d.css(this.cssSplashed()));return!1}},a.prototype.cssReflecting=function(a){var b,c,d,e,f,g;b=a.offset(),e=this.$root.offset(),d={top:b.top-e.top,left:b.left-e.left},g=this.options.observe;for(c in g)f=g[c],d[c]=a.css(c);return d.color=a.data("color"),d},a.prototype.cssSplashed=function(){return $.extend(this.makeSplashPos(),this.options.observe)},a.prototype.makeSplashPos=function(){return Math.random()<.5?{top:Math.random()<.5?-20:this.$root[0].clientHeight+10,left:Math.random()*this.$root[0].clientWidth}:{top:Math.random()*this.$root[0].clientHeight,left:Math.random()<.5?-120:this.$root[0].clientWidth+10}},a.prototype.choiceSequence=function(a){return a.shift()},a.prototype.choiceRandom=function(a){var b,c;return b=Math.floor(Math.random()*a.length),c=a[b],a.splice(b,1),c},a.prototype.transitionDuration=function(a){return Math.max(.9-a.length/14,.2)},a.prototype.characterGroup=function(a,b){return 32===a||12352===a?"space":a>=33&&63>=a||a>=58&&64>=a||a>=91&&94>=a||96===a||a>=123&&127>=a?"symbol":a>=48&&57>=a?"number":a>=65&&90>=a||a>=97&&122>=a||95===a?"identifier":a>=12353&&12447>=a||"hiragana"===b&&12540===a?"hiragana":a>=12448&&12543>=a?"katakana":a>=13312&&40959>=a?"kanji":"others"},a.prototype.showCurrent=function(){return null!=this.index?this.showAt(this.index,!0):void 0},a.prototype.showPrev=function(){return null!=this.index?this.showAt((this.pages.length+this.index-1)%this.pages.length):void 0},a.prototype.showNext=function(){return null!=this.index?this.showAt((this.index+1)%this.pages.length):void 0},a}(),window.UgoSlide=a}).call(this);