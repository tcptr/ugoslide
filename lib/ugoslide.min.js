(function(){var a;$.fn.extend({offsetFrom:function(a){var b,c;return b=a.offset(),c=this.offset(),{top:c.top-b.top,left:c.left-b.left}},eachTextNode:function(a){return this.contents().each(function(){switch(this.nodeType){case 3:return a.call(this,this);case 1:return $(this).eachTextNode(a)}})}}),a=function(){function a(a,b){this.$root=a,this.cssWord=null!=b?b:d,this.pages=this.$root.children(".page").map(function(){return $(this)}),this.wordElems={},this.rootSize={width:this.$root[0].clientWidth,height:this.$root[0].clientHeight},this.initStyle(),this.init()}var b,c,d;return a.prototype.initStyle=function(){var a,b,c,d,e,f,g,h,i,j;for(this.$words=$("<div />",{"class":"ugoline-words",css:{position:"absolute",overflow:"hidden",width:this.rootSize.width,height:this.rootSize.height,margin:0,zIndex:this.pages.length+1}}),this.$root.append(this.$words),this.$navigator=this.$root.find(".navigator"),this.$navigator.css("z-index",this.pages.length+2),h=this.pages,c=d=0,f=h.length;f>d;c=++d)b=h[c],b.css({position:"absolute",opacity:0,zIndex:c});for(i=[this.$root,this.$navigator],j=[],e=0,g=i.length;g>e;e++)a=i[e],j.push("static"===a.css("display")?a.css("display","relative"):void 0);return j},a.prototype.init=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this;for(g={},k=this.pages,i=0,j=k.length;j>i;i++){a=k[i],a.eachTextNode(function(a){var b;if(/\S/.test(a.data))return b=m.splitText(a.data),$(a).replaceWith(b)}),f={},a.find(".ugoslide-word-base").each(function(){var a,b;return a=$(this).text(),f[a]=(null!=(b=f[a])?b:0)+1});for(d in f)c=f[d],g[d]=Math.max(null!=(l=g[d])?l:0,c)}for(e in g)c=g[e],this.wordElems[e]=function(){var a,d;for(d=[],h=a=1;c>=1?c>=a:a>=c;h=c>=1?++a:--a)b=$("<span />",{"class":"ugoslide-word",text:e,css:$.extend({position:"absolute",margin:0,padding:0,userSelect:"none",transition:""+(1.3-e.length/12)+"s ease-out"},this.cssSplashed(this.cssWord))}),b.showed=!1,this.$words.append(b),d.push(b);return d}.call(this);return $(".ugoslide-word-base").each(function(){return b=$(this),b.data("color",b.css("color")),b.css("color","rgba(0,0,0,0)")})},a.prototype.choiceSequence=function(a){return a.shift()},a.prototype.choiceRandom=function(a){var b,c;return b=Math.floor(Math.random()*a.length),c=a[b],a.splice(b,1),c},a.prototype.characterGroup=function(a,b){return 32===a||12352===a?"space":a>=33&&63>=a||a>=58&&64>=a||a>=91&&96>=a||a>=123&&127>=a?"symbol":a>=48&&57>=a?"number":a>=65&&90>=a||a>=97&&122>=a?"alphabet":a>=12353&&12447>=a||"hiragana"===b&&12540===a?"hiragana":a>=12448&&12543>=a?"katakana":a>=13312&&40959>=a?"kanji":"others"},a.prototype.splitText=function(a){var d,e,f,g,h,i,j,k;for(h="",i="",e=this.characterGroup(a.charCodeAt(0)),f=0,g=function(){return 0!==i.length?(h+="space"===e?i:c+i+b,i=""):void 0},f=j=0,k=a.length;k>=0?k>j:j>k;f=k>=0?++j:--j)d=this.characterGroup(a.charCodeAt(f),e),d!==e&&(g(),e=d),i+=a.charAt(f);return g(),h},a.prototype.showAt=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;for(k=this.pages,i=0,j=k.length;j>i;i++)b=k[i],b.css("opacity",0);b=this.pages[a],b.css({opacity:1,transition:"1.5s ease-out"}),g={},l=this.wordElems;for(e in l)d=l[e],g[e]=$.merge([],d);b.find(".ugoslide-word-base").each(function(a,b){var c,d;return c=$(b),d=n.choiceRandom(g[c.text()]),d.showed=!0,d.css(n.cssReflecting(c,n.cssWord))}),m=[];for(h in g)f=g[h],m.push(function(){var a,b,d;for(d=[],a=0,b=f.length;b>a;a++)c=f[a],c.showed&&(c.showed=!1,d.push(c.css(this.cssSplashed(this.cssWord))));return d}.call(this));return m},a.prototype.cssReflecting=function(a,b){var c,d,e;d=a.offsetFrom(this.$root);for(c in b)e=b[c],d[c]=a.css(c);return d.color=a.data("color"),d},a.prototype.cssSplashed=function(a){return $.extend(this.makeSplashPos(),a)},a.prototype.makeSplashPos=function(){return Math.random()<.5?{top:Math.random()<.5?-20:this.rootSize.height+10,left:Math.random()*this.rootSize.width}:{top:Math.random()*this.rootSize.height,left:Math.random()<.5?-120:this.rootSize.width+10}},c='<span class="ugoslide-word-base">',b="</span>",d={fontSize:"10px",fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",color:"#fff"},a}(),window.UgoSlide=a}).call(this);